<!--blog_index.html-->

{% extends "base.html" %}

{% block title %}Blog Index{% endblock %}

{% block content %}
    <h1>Blog Posts</h1>

    <form action="{{ url_for('blog.blog_index') }}" method="GET" class="search-form-container" style="margin-bottom: 20px;">
        <input type="search"
               id="blog-search-input"
               name="search"
               placeholder="Search post titles or content..."
               value="{{ request.args.get('search', '') }}"
               class="form-input" style="width: 70%; display: inline-block;">

        <button type="submit" class="btn btn-primary" style="width: 25%; display: inline-block;">Search</button>
    </form>

    <p><a class="form-create" href="{{ url_for('blog.new_post') }}">Create a New Post</a></p>
    <hr>

    <section class="posts-list-section">
        {% for post in posts %}
            <article class="post-item">
                <header>
                    <h2 class="post-title">
                        <a href="{{ url_for('blog.view_post', post_id=post.id) }}">{{ post.title }}</a>
                    </h2>
                    <p class="post-meta">
                        Posted by **{{ post.post_author.username }}** on <time datetime="{{ post.date_posted.isoformat() }}">{{ post.date_posted.strftime('%B %d, %Y') }}</time>
                    </p>
                </header>

                <div class="post-preview">
                    <p>{{ post.content }}</p>
                </div>

                {% if current_user.is_authenticated and post.post_author.id == current_user.id %}
                    <div class="post-actions">
                        <a href="{{ url_for('blog.edit_post', post_id=post.id) }}" class="btn-small">Edit</a> |

                        <form action="{{ url_for('blog.delete_post', post_id=post.id) }}" method="POST" style="display: inline;">
                            <button type="submit"
                                    onclick="return confirm('WARNING: Are you absolutely sure you want to delete this post?')"
                                    class="delete-btn">
                                Delete
                            </button>
                        </form>
                    </div>
                {% endif %}

                <hr>
            </article>
        {% else %}
            <p class="no-posts">No posts found. Start writing!</p>
        {% endfor %}
    </section>
{% endblock %}