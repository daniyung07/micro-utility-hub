<!--task_index.html-->

{% extends "base.html" %}

{% block title %}My To-Do List{% endblock %}

{% block content %}
    <section class="tasks-list-container">
        <h1>My Tasks</h1>
        <hr>

        <p><a class="form-create" href="{{ url_for('tasks.new_task') }}">Add a New Task</a></p>

        {% if user_tasks %}
            <table class="tasks-table">
                <caption>Your Personal To-Do List</caption>
                <thead>
                    <tr>
                        <th class="done-col">Done</th>
                        <th class="title-col">Task Title</th>
                        <th class="details-col">Details</th>
                        <th class="actions-col">Actions</th>
                    </tr>
                </thead>
                <tbody>
                {% for task in user_tasks %}
                    <tr class="{% if task.completed %}completed{% endif %}">
                        <td>
                            <form action="{{ url_for('tasks.complete_task', task_id=task.id) }}" method="POST">
                                <input type="checkbox"
                                    name="completed"
                                    value="True"
                                    {% if task.completed %}checked{% endif %}
                                    onchange="this.form.submit()">
                            </form>
                        </td>

                        <td class="title-col">
                            {{ task.title }}
                            <span class="created-date"> (Created: <time datetime="{{ task.date_posted.isoformat() }}">{{ task.date_posted.strftime('%b %d') }}</time>)</span>
                        </td>

                        <td class="details-col">
                            {{ task.content }}
                        </td>

                        <td class="actions-col">
                            <form action="{{ url_for('tasks.delete_task', task_id=task.id) }}" method="POST" style="display: inline;">
                                <button type="submit"
                                        onclick="return confirm('Are you sure you want to delete this task?')"
                                        class="delete-btn">
                                    Delete
                                </button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p class="no-tasks">You have no tasks! Start by adding one above.</p>
        {% endif %}
    </section>
{% endblock %}